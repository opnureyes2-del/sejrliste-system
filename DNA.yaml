# ═══════════════════════════════════════════════════════════════
# SEJR LISTE SYSTEM - DNA
# ═══════════════════════════════════════════════════════════════
#
# WHAT:  System DNA — selvbevidsthed, metadata, og konfiguration
#        Definerer 7 DNA lag, scoring, og filstruktur
# WHY:   Single Source of Truth for systemets identitet og regler
# WHO:   Laest af: enforcement_engine.py, build_claude_context.py
#        Refereret af: generate_sejr.py, auto_verify.py
# HOW:   YAML format — redigeres manuelt, ALDRIG auto-genereret
#
# Version: 3.0.0 - UNIFIED CROSS-DEVICE APP
# ═══════════════════════════════════════════════════════════════

meta:
  created: "2026-01-23T06:30:00+01:00"
  created_by: "Kv1nt (Claude Sonnet 4.5)"
  updated: "2026-01-31T19:00:00+01:00"
  updated_by: "Kv1nt (Claude Opus 4.5)"
  version: "3.0.0"
  version_name: "UNIFIED CROSS-DEVICE APP"
  purpose: "3 brugerflader (GTK4 + Web + TUI), cross-device, self-learning"

# ═══════════════════════════════════════════════════════════
# SINGLE SOURCE OF TRUTH PRINCIP (NYHED i v2.1.0)
# ═══════════════════════════════════════════════════════════

single_source_of_truth:
  enabled: true
  description: "Ingen data eksisterer to steder"

  master_files:
    AUTO_LOG.jsonl: "Alt logging (handlinger, terminal, actors)"
    STATUS.yaml: "Alt status (pass, score, model tracking)"

  eliminated_redundancy:
    - "VERIFY_STATUS.yaml → Merged into STATUS.yaml"
    - "ADMIRAL_SCORE.yaml → Merged into STATUS.yaml"
    - "MODEL_HISTORY.yaml → Merged into STATUS.yaml"
    - "TERMINAL_LOG.md → Data in AUTO_LOG.jsonl"

  sejr_files_count: 4  # Ned fra 7

system_identity:
  name: "Sejr Liste System"
  type: "3-Pass Konkurrence + Tracking System"
  location: "/home/rasmus/Desktop/sejrliste systemet"
  standalone: true

# ═══════════════════════════════════════════════════════════
# 3-PASS KONKURRENCE SYSTEM (NYHED i v2.0.0)
# ═══════════════════════════════════════════════════════════

three_pass_system:
  enabled: true
  description: "Hver opgave gennemgås 3 gange med tvunget forbedring"

  pass_1:
    name: "Planlægning"
    focus: "Research, design, plan"
    score_requirement: "Baseline"
    phases: ["PHASE 0: Research", "PHASE 1: Planning", "PHASE 2: Verify Plan"]

  pass_2:
    name: "Eksekvering"
    focus: "Implementer, test, git"
    score_requirement: "> Pass 1"
    phases: ["PHASE 2: Development", "PHASE 3: Test", "PHASE 4: Git"]

  pass_3:
    name: "7-DNA Review"
    focus: "Find mangler, fejl, optimeringer"
    score_requirement: "> Pass 2"
    phases: ["7 DNA Lag Checkliste", "Final Verification", "Git & Docs"]

  archive_requirements:
    - "Alle 3 passes complete"
    - "Pass 2 score > Pass 1 score"
    - "Pass 3 score > Pass 2 score"
    - "Total score >= 24/30"
    - "5+ tests passed"
    - "7-DNA gennemgang dokumenteret"

# ═══════════════════════════════════════════════════════════
# CLAUDE FOKUS SYSTEM (NYHED i v2.0.0)
# ═══════════════════════════════════════════════════════════

claude_focus_system:
  enabled: true
  description: "Dynamisk CLAUDE.md der tvinger AI fokus"

  components:
    - "SYSTEM_REGLER.md - Obligatoriske regler for AI"
    - "CLAUDE.md - Dynamisk fokus lock per sejr"
    - "build_claude_context.py - Dynamisk CLAUDE.md builder"
    - "sejr-fokus-enforcer skill - Auto-aktivering"

  anti_dum_checkpoints:
    frequency: "Hver 5 handlinger"
    action: "Genlæs CLAUDE.md og bekræft task"

  forbidden_actions:
    - "Arbejde på andet end current sejr"
    - "Skippe passes"
    - "Arkivere før 3-pass done"
    - "Sige 'færdig' uden bevis"
    - "ÆNDRE CSS/DESIGN UDEN EKSPLICIT ORDRE (2026-01-26)"
    - "ÆNDRE KODE DER VIRKER UDEN GODKENDELSE (2026-01-26)"
    - "VERIFICERE KODE UDEN AT TESTE FUNKTIONALITET (2026-01-26)"

# ═══════════════════════════════════════════════════════════
# 7 DNA LAG
# ═══════════════════════════════════════════════════════════

dna_layers:
  1_self_aware:
    enabled: true
    description: "System kender sin egen state"
    implementation: "DNA.yaml + VERIFY_STATUS.yaml"

  2_self_documenting:
    enabled: true
    description: "Auto-logger alle handlinger"
    implementation: "AUTO_LOG.jsonl per sejr"

  3_self_verifying:
    enabled: true
    description: "Auto-verificerer med 3-pass tracking"
    implementation: "auto_verify.py + VERIFY_STATUS.yaml"

  4_self_improving:
    enabled: true
    description: "Lærer patterns fra færdige sejr"
    implementation: "auto_learn.py + PATTERNS.yaml"

  5_self_archiving:
    enabled: true
    description: "Arkiverer semantisk (BLOKERET til 3-pass done)"
    implementation: "auto_archive.py + 90_ARCHIVE/"

  6_predictive:
    enabled: true
    description: "AI-foreslår næste skridt"
    implementation: "auto_predict.py + NEXT.md"

  7_self_optimizing:
    enabled: true
    description: "3 alternativer før bygning"
    implementation: "PHASE 0 i SEJR_LISTE.md"

# ═══════════════════════════════════════════════════════════
# ADMIRAL KONKURRENCE SYSTEM (NYHED i v2.0.0)
# ═══════════════════════════════════════════════════════════

admiral_konkurrence:
  enabled: true
  description: "Score system der måler AI performance objektivt"

  positive_metrics:
    - "CHECKBOX_DONE: +1"
    - "PASS_COMPLETE: +10"
    - "VERIFIED_WORKING: +5"
    - "TEST_PASSED: +3"
    - "ADMIRAL_MOMENT: +10"
    - "SEJR_ARCHIVED: +20"

  negative_metrics:
    - "TOKEN_WASTE: -3 (×2 = -6)"
    - "MEMORY_LOSS: -5 (×2 = -10)"
    - "LIE_DETECTED: -10 (×2 = -20)"
    - "RULE_BREAK: -10 (×2 = -20)"

  formula: "total = positive - (negative × 2)"

  ranks:
    STORADMIRAL: 150
    ADMIRAL: 100
    KAPTAJN: 50
    LØJTNANT: 20
    KADET: 0
    SKIBSDRENG: -999

  files:
    - "ADMIRAL_KONKURRENCE.md - System dokumentation"
    - "ADMIRAL_SCORE.yaml - Per-sejr score tracking"
    - "_CURRENT/LEADERBOARD.md - Global leaderboard"
    - "scripts/admiral_tracker.py - Score management"

# ═══════════════════════════════════════════════════════════
# SCRIPTS (15 Python + 8 Shell + 1 shared module = 24 stk)
# ═══════════════════════════════════════════════════════════

scripts:
  python_count: 15
  shell_count: 8
  shared_modules_count: 1
  total_count: 24

  python_scripts:
    - name: "generate_sejr.py"
      purpose: "Opret ny sejr med alle 4 filer (atomisk)"
    - name: "auto_verify.py"
      purpose: "3-pass verification + scoring"
    - name: "auto_archive.py"
      purpose: "Arkivering (blokeret til 3-pass done)"
    - name: "build_claude_context.py"
      purpose: "Byg DYNAMISK CLAUDE.md fra actual state"
    - name: "update_claude_focus.py"
      purpose: "Opdater CLAUDE.md state"
    - name: "auto_track.py"
      purpose: "State tracking + STATE.md"
    - name: "auto_learn.py"
      purpose: "Pattern learning + PATTERNS.json"
    - name: "auto_predict.py"
      purpose: "Predictions + NEXT.md"
    - name: "admiral_tracker.py"
      purpose: "Konkurrence score tracking + leaderboard"
    - name: "auto_health_check.py"
      purpose: "System integrity guard — finder + reparerer problemer (12 checks)"
    - name: "automation_pipeline.py"
      purpose: "Kvalitets-pipeline: syntax, linting, security, rapport"
    - name: "token_tools.py"
      purpose: "Token counting, cost estimation + lokal fil-cache"
    - name: "yaml_utils.py"
      purpose: "Delt YAML modul (PyYAML wrapper, erstatter buggy flat parser)"
    - name: "view.py"
      purpose: "Terminal status viewer for aktive sejr"
    - name: "generate_icon_sizes.py"
      purpose: "Generér PNG varianter af SVG icons (rsvg-convert)"

  shared_modules:
    - name: "checkbox_utils.py"
      location: "root"
      purpose: "Centraliseret count_checkboxes() — importeret af web_app, masterpiece, auto_verify, pages/"

  shell_scripts:
    - name: "sejr_dashboard.sh"
      purpose: "Enforcement dashboard — formateret terminal overblik"
    - name: "sejrliste_status.sh"
      purpose: "Unified system overview (apps, URLs, sejr, patterns)"
    - name: "sejr-watch.sh"
      purpose: "Realtids overvagning via inotifywait"
    - name: "sejr-terminal.sh"
      purpose: "Interaktiv terminal med kommandoer (verify, track, predict, learn)"
    - name: "cron_auto_learn.sh"
      purpose: "Cron wrapper for auto_learn med log rotation"
    - name: "cron_health_check.sh"
      purpose: "Cron wrapper for health check + desktop notification ved fejl"
    - name: "show_phone_url.sh"
      purpose: "Vis telefon-URL + QR kode for web app"
    - name: "start_web_en.sh"
      purpose: "Start Streamlit web app (English) paa port 8502"

# ═══════════════════════════════════════════════════════════
# STATUS
# ═══════════════════════════════════════════════════════════

status:
  operational: true
  last_updated: "2026-01-25T00:30:00+01:00"
  active_sejr_count: 1
  archived_sejr_count: 2

# ═══════════════════════════════════════════════════════════
# FILER I SYSTEMET
# ═══════════════════════════════════════════════════════════

files:
  root:
    - "README.md - Overblik (v3.0.0)"
    - "DNA.yaml - Denne fil"
    - "checkbox_utils.py - Delt modul: centraliseret count_checkboxes()"
    - "enforcement_engine.py - 3-pass enforcement"
    - "intro_integration.py - INTRO integration"
    - "masterpiece_en.py - GTK4 desktop app (English)"
    - "masterpiece.py - GTK4 desktop app (Danish)"
    - "web_app.py - Streamlit web app (Danish)"
    - "web_app_en.py - Streamlit web app (English)"
    - "start-web.sh - Systemd startup script"
    - "app/sejr_app.py - TUI app (Textual)"
  docs:
    - "docs/ARBEJDSFORHOLD.md - KOMPLET MODEL VEJLEDNING"
    - "docs/MANUAL.md - Komplet manual (390 linjer)"
    - "docs/ARKITEKTUR.md - System arkitektur"
    - "docs/LOG_FORMAT.md - Log format specifikation (ADMIRAL STANDARD)"
    - "docs/ADMIRAL.md - Admiral standard"
    - "docs/EKSEMPLER.md - Eksempler"
    - "docs/SCRIPT_REFERENCE.md - Script reference"
    - "docs/MODEL_ONBOARDING.md - Model onboarding"
    - "docs/PREVENTION_RULES.md - Forebyggelsesregler"
    - "docs/INCOMPLETE_CHECK.md - Ufuldendt-check"

  templates:
    - "00_TEMPLATES/SEJR_TEMPLATE.md - Master template med 3-pass"
    - "00_TEMPLATES/CLAUDE.md - Fokus lock template"
    - "00_TEMPLATES/STATUS_TEMPLATE.yaml - Unified status template"
    - "00_TEMPLATES/SESSION_TJEK.md - Session start tjekliste"

  sejr_mappe:
    - "SEJR_LISTE.md - Hovedopgave (3 passes)"
    - "CLAUDE.md - Dynamisk fokus lock (genereret)"
    - "STATUS.yaml - UNIFIED (pass + score + model tracking)"
    - "AUTO_LOG.jsonl - MASTER (alt logging)"

# ═══════════════════════════════════════════════════════════
# ADMIRAL STANDARDS
# ═══════════════════════════════════════════════════════════

admiral_compliance:
  rule_16_verification: true
  rule_28_git_complete: true
  rule_0c_300_faerdig: true
  foer_under_efter: true
  three_pass_konkurrence: true  # NYHED

quality_standards:
  semantic_focus: "Max 500 lines context"
  automation_level: "90% auto, 10% human"
  token_efficiency: "<1000 tokens per resume"
  visual_clarity: "Progress visible in <5 seconds"
  forced_improvement: "Pass scores MUST increase"  # NYHED

# ═══════════════════════════════════════════════════════════
# VERIFICATION
# ═══════════════════════════════════════════════════════════

verification:
  system_exists: "ls '/home/rasmus/Desktop/sejrliste systemet'"
  scripts_count: "ls scripts/*.py | wc -l  # Expected: 15"
  templates_count: "ls 00_TEMPLATES/* | wc -l  # Expected: 4"
  view_works: "python3 view.py"
  generate_works: "python3 scripts/generate_sejr.py --name 'Test'"
  verify_works: "python3 scripts/auto_verify.py --all"
